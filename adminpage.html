<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  
    <title>Document</title>
</head>
<style>
    .course_class{
        border-top: 1px solid;
        border-bottom: 1px solid;
        border-left: 1px solid;
        border-right: 1px solid;
        border-radius: 10px;
        height: 100px;
        text-align: center;
        padding-top: 30px;
        border-color: white;
        background-color: rgb(239,249,255);
    
    }
    
</style>
<script type="modeule" src="./task1.html">
</script>
<script>
    let list=[];
    /* let table=document.createElement("table");
    table.id="table";
    table.style.display="none"; */
    let maindiv=document.createElement("div");
    maindiv.style.justifyContent="center";
    maindiv.style.textAlign="center";
    maindiv.style.alignItems="center";
    maindiv.style.display="flex";
   
    let table=document.createElement("table");
    table.style.justifyContent="center";
    table.style.textAlign="center";
    table.style.alignItems="center";
    //table.innerHTML=`<tr><th style="width:20%"></th><th style="width:70%"></th ></tr>`;
    function listofcourses(){
        let k=0;
        list=[];
        let object=Object.entries(localStorage);
        for (let i of object) {
          //  console.log(typeof(i));
            let j=i[0];
                //console.log(j);
                let word="";
              for(let k of j){
                //console.log(k)
            if(k===" " ){
                break;
            }
            else{
                word=word+k;
            }
            if(word==="course"){
            list.push(i);
            //k++;
            } 
            }
        }
    }
        let count=0;
       
        function display(){
            if(table.style.display=="none"){
            table.style.display="block";
        }
        else{
            table.style.display="none";
        }
        }
function courseslistup(){
    listofcourses();
    document.getElementById("showingpage").style.display="none";
    console.log(list);
    table.innerHTML=""
    table.style.display="flex";
   let tr=document.createElement("tr");
   tr.id="tr";
   tr.style.marginLeft="2cm";
   let newtr=document.createElement("tr");
   let flag;
        let div=document.createElement("div");
        div.id="list_courses";

         for(let i of list){
            count++;
            let k=0;
            
            let imglink=i[1];
            let td=document.createElement("td");
            
            let wholecourse=String(i).split(',');
            let course=String(wholecourse[0]).split(" ");
            let coursename=course[1];
            let courselink=course[2];
            console.log(courselink);
            console.log(imglink);
            td.innerHTML=`<h3>${coursename}</h3><img id="image" src="${imglink}" style="width:200px;height:200px"><br><a href="${courselink}" style="color:black;margin-left:2px">${courselink}</a>`;
        
       
            tr.append(td);
        }
         table.append(tr);
         maindiv.append(table);
        
         document.body.appendChild(maindiv);
         
        //console.log(list);
        }
    function upload_course(){
        table.style.display="none";
        document.getElementById("showingpage").style.display="none";
       document.getElementById("course").onclick="";
       let div=document.createElement("div");
       div.style.backgroundColor="rgb(94, 105, 115";
       div.style.textAlign="center";
       div.style.paddingTop="20px";
       div.id="iframediv";
       //console.log(div);
       
        let ifrm = document.createElement("iframe");
        ifrm.setAttribute("src", "upload_course.html");
        ifrm.style.width = "400px";
        ifrm.style.height = "500px";
        ifrm.id="ifrm";
        let button=document.createElement("button");
        button.type=button;
        button.textContent="update";
        button.style.width="70px";
        button.style.height="30px";
        button.onclick=function(){
        
            update();
            
        };
        button.id="btn";
        div.append(button);
        div.append(ifrm);
        //document.getElementById("upload").append(button);
        document.body.appendChild(div);
       }
       function update(){
        document.getElementById("course").onclick=courseslistup;
     
         let remove=document.getElementById("iframediv");
         remove.parentNode.removeChild(remove);

         //table.hidden ="false";
         
       }
       function removecourse(){
        listofcourses();
        document.getElementById("showingpage").style.display="none";
        let maindiv1=document.createElement("div");
          maindiv1.style.display="flex";
          maindiv1.style.marginLeft="20%"
        //  maindiv1.style.justifyContent="center";
    maindiv1.style.marginTop="20px";
   // maindiv1.style.marginBottom="40px";
  //  maindiv1.style.alignItems="center";
    //maindiv1.style.display="flex";
    
    table.innerHTML=""
    table.style.display="block";
    table.style.width="90%";
    table.style.height="100%";
   
   for(let i of list){
        count++;
        let k=0;
        
        let tr=document.createElement("tr");
        let imglink=i[1];
        let td=document.createElement("td");
        let td2=document.createElement("td");
        let td3=document.createElement("td");
        let wholecourse=String(i).split(',');
        let course=String(wholecourse[0]).split(" ");
        let coursename=course[1];
            let courselink=course[2];
            console.log(courselink);
            console.log(imglink);
            td.innerHTML=`<h3 id='${coursename}'>${coursename}</h3><img id="${imglink}" src="${imglink}" style="width:200px;height:200px"><br><a href="${courselink}" style="color:black;margin-left:2px" id="${courselink}">${courselink}</a>`;
           
            tr.style.marginTop="40px";
           // tr.style.backgroundColor="rgb(181, 198, 215)";
            td2.style.width="80%";
            td3.style.width="40%";
            
            td2.style.textAlign="center";
            td2.innerHTML=`<button type="button" class="btn btn-danger" onclick="deletee(event)">Delete</button>`; 
            
            tr.append(td);
            tr.append(td3);
            tr.append(td2);
            table.append(tr);
        }
        
         
         maindiv1.append(table);
        
         document.body.appendChild(maindiv1);
        
       }
       function deletee(event){
        let targett=event.target.parentNode.parentNode;
   let child=targett.firstChild;
   
   let itemdelete=child.textContent;
   console.log(child);
   for(let i of list){
    let check=i[0];
    let chceking=String(check).split(" ");
    console.log(chceking);
    let newvalue=chceking[1]+chceking[2];
    console.log(newvalue);
    let index=list.indexOf(i);
    console.log(index);
   if(newvalue===itemdelete){
      list=list.splice(index,1);
      localStorage.removeItem(`course ${chceking[1]} ${chceking[2]}`);
      break;
   }
   
    
    }
    console.log(list);

   let p=event.target.parentNode.parentNode;
   p.parentNode.removeChild(p);
  
   
   }
function getname(){
    localStorage.getItem();
}
function logout(){
    let list1=[];
    let object=Object.entries(localStorage);
        for (let i of object) {
            console.log(i);
            let j=i[0];
                //console.log(j);
            
                let word='';
            for(let k of j){
                //console.log(k)
            if(k===" " ){
                break;
            }
            else{
                word=word+k;
            }
            if(word==="admin"){
                console.log(localStorage.key(j));
                localStorage.removeItem(localStorage.key(j));
                window.location.href="login.html";
             //k++;
            } 
            }
        }
}
function showfront(){
    alert("you need to logout existing id for new one to login");
    let h1=document.createElement("h1");
    let k=0;
        let list1=[];
        let object=Object.entries(localStorage);
        for (let i of object) {
          //  console.log(typeof(i));
          list1=[]
            let j=i[0];
                //console.log(j);
            
                let word='';
            for(let k of j){
                //console.log(k)
            if(k===" " ){
                break;
            }
            else{
                word=word+k;
            }
            if(word==="admin"){
            list1.push(i);
            h1heading=String(list1).slice(String(list1).indexOf(",")+1);
            //k++;
            } 
            }
        }
   h1.innerHTML=`${h1heading}`;
   document.getElementById("h1").append(h1);
    document.getElementById("showingpage").style.display="flex";
}
function assigncourse(){
    listofcourses();
        document.getElementById("showingpage").style.display="none";
        let maindiv1=document.createElement("div");
          maindiv1.style.display="flex";
          maindiv1.style.marginLeft="20%"
        //  maindiv1.style.justifyContent="center";
    maindiv1.style.marginTop="20px";
   // maindiv1.style.marginBottom="40px";
  //  maindiv1.style.alignItems="center";
    //maindiv1.style.display="flex";
    
    table.innerHTML=""
    table.style.display="block";
    table.style.width="90%";
    table.style.height="100%";
   
   for(let i of list){
        count++;
        let k=0;
        
        let tr=document.createElement("tr");
        let imglink=i[1];
        let td=document.createElement("td");
        let td2=document.createElement("td");
        let td3=document.createElement("td");
        let wholecourse=String(i).split(',');
        let course=String(wholecourse[0]).split(" ");
        let coursename=course[1];
            let courselink=course[2];
            console.log(courselink);
            console.log(imglink);
            td.innerHTML=`<h3 id='${coursename}'>${coursename}</h3><img id="${imglink}" src="${imglink}"  style="width:200px;height:200px"><br><a href="${courselink}" style="color:black;margin-left:2px" id="${courselink}">${courselink}</a>`;
           
            tr.style.marginTop="40px";
           // tr.style.backgroundColor="rgb(181, 198, 215)";
            td2.style.width="80%";
            td3.style.width="40%";
            td3.id="td3";
            td2.style.textAlign="center";
            td2.innerHTML=`<button type="button" class="btn btn-danger" onclick="assign(event)" id="assignbutton">assign-${coursename}</button>`; 
        td2.id=td2;
            tr.append(td);
           
            tr.append(td2);
            tr.append(td3);
            table.append(tr);
        }
        
         
         maindiv1.append(table);
        
         document.body.appendChild(maindiv1);
    
}
function assign(event){
  let name=event.target.textContent;
    let div3=document.createElement("div");
    let dialog=document.createElement("dialog");

    document.getElementById("assignbutton").onclick="";
          div3.innerHTML=`<p onclick="selectingstudents(event)" id=${name}>click for selecting the students whome yoou want to assign coure</p>`;
          document.getElementById("td3").innerHTML="<h3>select students here</h3><br>";
      
          document.getElementById("td3").append(div3);
     //    document.body.append(div3);
  //  dialog.innerHTML=div3.innerHTML;
   // dialog.show();
}
function selectingstudents(event){
    let id=event.target.id;
    let div=document.createElement("div");
   
    let select=document.createElement("select");
    select.multiple="true";
    select.id="selectassingstudents";
    let list1=[];
    let add=document.createElement("p");
    add.innerHTML=`<p>Hold down the Ctrl (windows) or Command (Mac) button to select multiple options.</p>`

    let object=Object.entries(localStorage);
        for (let i of object) {
          //  console.log(typeof(i));
            let j=i[0];
               li=j.split(" ");
               //console.log(li);
                let word="";
                 if(li[0].endsWith("/student")){
                    list1.push(li[0]);
                   let option=document.createElement("option");
                   option.textContent=li[0];
                   option.value=li[0];
                   select.append(option);
                    
                 }
        }
       

    div.append(select);
    div.append(add)
    let p=document.createElement("p");
    p.innerHTML=`<button style="width:200px;height:50px" onclick="showstudents(event)" >${id}</button>`
    document.getElementById("td3").append(div);
    document.getElementById("td3").append(p);
   }
    
   function showstudents(event){
    let an=event.target.textContent;
   let selectelement=document.getElementById("selectassingstudents");
   console.log(selectelement);
   //let options=selectelement.options[selectelement.selectedIndex].value;
   const selectedOptions = [];
   for (const option of selectelement.options) {
    if (option.selected) {
      selectedOptions.push(option.value);
    }
  }
  console.log(selectedOptions);

   /*  let val=event.target.parentNode.parentNode.parentNode.parentNode.firstChild.firstChild.firstChild;
    let valadd=val.textContent; */
    console.log(an);
    localStorage.setItem(`${an}`,selectedOptions);
    
  for (const option of selectelement.options) {
    if (option.selected) {
      selectedOptions.push(option.value);
    }
}
document.getElementById("td3").innerHTML="";
}
        </script>
<body onload="showfront()">
    <nav class="navbar navbar-expand-lg bg-info text-dark">

        <div class="container-fluid" id="h1">
          <a class="navbar-brand" href="#">Home</a>
          </div>
        
      </nav>
      <nav class="navbar bg-body-tertiary">
       
      </nav>
      <button onclick="logout()">logout</button>
      <div class="container course_class">
        <div class="row">
          <div class="col" id="course" onclick="courseslistup()">
         courses
          </div>
          <div class="col" onclick="upload_course()" id="upload">
            upload course
          </div>
          
          <div class="col" onclick="removecourse()">
            remove course
          </div>
          <div class="col" onclick="assigncourse()">
            assign
          </div>
          <div id="all" style="display: flex;">

          </div>
        </div>
      </div>
      <div id="showingpage"  style="background-color: rgb(239,249,255); height: 100%; align-items: center; justify-content: center; padding-top: 10%; padding-bottom: 10%;width: 65%; margin-left: 8cm;display: flex;margin-top: 2cm;">
       <h1> wellcome to lms </h1>
      </div>
      
</body>
</html>